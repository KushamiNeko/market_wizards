package hashutils

//////////////////////////////////////////////////////////////////////////////////////////////////////

import (
	"crypto/rand"
	"encoding/base64"
	"io"
	"net/url"
)

////////////////////////////////////////////////////////////////////////////////////////////////////////

//func RandBytesGenerateB64(bytesLength int) string {
func RandBytesB64(bytesLength int) string {

	//nonce := RandBytesGenerate(bytesLength)
	nonce := RandBytes(bytesLength)

	return base64.StdEncoding.EncodeToString(nonce)
}

////////////////////////////////////////////////////////////////////////////////////////////////////////

//func RandBytesGenerate(bytesLength int) []byte {
func RandBytes(bytesLength int) []byte {
	nonce := make([]byte, bytesLength)

	var err error
	for {
		_, err = io.ReadFull(rand.Reader, nonce)
		if err == nil {
			break
		}
	}

	return nonce
}

////////////////////////////////////////////////////////////////////////////////////////////////////////

//func RandBytesGenerateB64URL(bytesLength int) string {
func RandBytesB64URL(bytesLength int) string {
	return url.PathEscape(RandBytesB64(bytesLength))
}

////////////////////////////////////////////////////////////////////////////////////////////////////////
