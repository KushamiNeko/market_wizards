package hashutils

//////////////////////////////////////////////////////////////////////////////////////////////////////

import (
	"crypto/rand"
	"encoding/base64"
	"io"
	"net/url"
)

////////////////////////////////////////////////////////////////////////////////////////////////////////

func RandBytesGenerateB64(bytesLength int) string {

	nonce := RandBytesGenerate(bytesLength)

	return base64.StdEncoding.EncodeToString(nonce)
}

////////////////////////////////////////////////////////////////////////////////////////////////////////

func RandBytesGenerate(bytesLength int) []byte {
	nonce := make([]byte, bytesLength)

	var err error
	for {
		_, err = io.ReadFull(rand.Reader, nonce)
		if err == nil {
			break
		}
	}

	return nonce
}

////////////////////////////////////////////////////////////////////////////////////////////////////////

func RandBytesGenerateB64URL(bytesLength int) string {
	return url.PathEscape(RandBytesGenerateB64(bytesLength))
}

////////////////////////////////////////////////////////////////////////////////////////////////////////
